# Get the current folder path
$currentFolderPath = Get-Location

# Get all executable files in the current folder
$executableFiles = Get-ChildItem $currentFolderPath -Filter *.exe

# Loop through each executable file
foreach ($file in $executableFiles) {
    # Check if DEP is enabled
    $depEnabled = $file.GetAccessControl().GetProtection().HasFlag([System.Security.AccessControl.SecurityInfos]::ProcessTrustLabel)
    if ($depEnabled) {
        Write-Host "DEP (Data Execution Prevention) is enabled for $($file.FullName)"
    } else {
        Write-Host "DEP (Data Execution Prevention) is not enabled for $($file.FullName)"
    }

    # Check if ASLR is enabled
    $aslrEnabled = $file.GetAccessControl().GetProtection().HasFlag([System.Security.AccessControl.SecurityInfos]::Image)
    if ($aslrEnabled) {
        Write-Host "ASLR (Address Space Layout Randomization) is enabled for $($file.FullName)"
    } else {
        Write-Host "ASLR (Address Space Layout Randomization) is not enabled for $($file.FullName)"
    }

    Write-Host "------------------------"
}
