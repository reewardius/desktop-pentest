# Получаем список всех файлов (включая скрытые) в текущей папке
# Получаем ссылку на рабочую папку екзешника для дальнейшего анализа этой папки
$files = Get-ChildItem -Path $PWD -File -Force

foreach ($file in $files) {
    # Проверяем, является ли файл .exe или ярлыком
    if ($file.Extension -eq ".exe") {
        Write-Output "Найден .exe файл: $($file.FullName)"
    }
    elseif ($file.Extension -eq ".lnk") {
        $target = (New-Object -ComObject WScript.Shell).CreateShortcut($file.FullName).TargetPath
        if (-not [string]::IsNullOrEmpty($target) -and (Test-Path $target -PathType Leaf -Include "*.exe")) {
            Write-Output "Ярлык $($file.Name) указывает на .exe файл: $target"
        }
    }
}

