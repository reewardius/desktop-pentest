$directory = Get-Location

# Получаем список всех файлов в текущей папке
$files = Get-ChildItem -Path $directory

foreach ($file in $files) {
    # Проверяем, является ли файл exe или dll
    if ($file.Extension -eq ".exe" -or $file.Extension -eq ".dll") {
        Write-Host "File: $($file.FullName)"
        $properties = Get-ItemProperty -Path $file.FullName

        if ($properties.'DEP ASLR') {
            Write-Host "DEP: $($properties.'DEP ASLR'.DEP)"
            Write-Host "ASLR: $($properties.'DEP ASLR'.ASLR)"
        } else {
            Write-Host "DEP and ASLR information not available."
        }
        Write-Host "-----------------------------"
    }
}
