$directory = Get-Location

# Get all items (files and folders) in the current directory
$items = Get-ChildItem -Path $directory

foreach ($item in $items) {
    Write-Host "Checking permissions for $($item.FullName)"
    $acl = Get-Acl -Path $item.FullName
    $accessRules = $acl.Access
    
    # Create an empty array to store users/groups with access
    $allowedAccess = @()

    foreach ($rule in $accessRules) {
        # Check if the user/group has unnecessary or excessive permissions
        if ($rule.FileSystemRights -band ([System.Security.AccessControl.FileSystemRights]::FullControl -bxor [System.Security.AccessControl.FileSystemRights]::Modify)) {
            # Add the user/group to the list of allowed access
            $allowedAccess += $rule.IdentityReference
        }
    }

    # Output the item name and users/groups with access
    Write-Host "`t[$($allowedAccess -join ', ')] has access to $($item.Name)"
}
